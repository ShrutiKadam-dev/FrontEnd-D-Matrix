<h3>Welcome To The {{pmsDetails[0]?.scripname}}</h3>

<div class="table-card">
  <div class="search-header p-d-flex p-ai-center p-jc-between">
    <h4>
      Summary Of Client Actions
      <button pButton type="button" label="IRR = {{ irrResult || 0 }}%" class="p-button-sm ml-2"
        style="height: 28px;"></button>
    </h4>
    <div class="search-container">
      <input pInputText type="text" (input)="onGlobalFilter($event, 'action')" placeholder="Search actions..." />
    </div>
  </div>

  <p-table #actionTableSummary [value]="actionTableList" dataKey="id" [paginator]="true" [rows]="10"
    [rowsPerPageOptions]="[10,25,50]"
    [globalFilterFields]="['sett_no','unit','order_number','purchase_amount','redeem_amount']" scrollHeight="600px"
    responsiveLayout="scroll" [resizableColumns]="true" columnResizeMode="expand" class="custom-table">

    <!-- Header -->
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="order_type">Action <p-sortIcon field="order_type"></p-sortIcon></th>
        <th pSortableColumn="trade_price">Trade Price <p-sortIcon field="trade_price"></p-sortIcon></th>
        <th pSortableColumn="cheque">Cheque <p-sortIcon field="cheque"></p-sortIcon></th>
        <th pSortableColumn="trade_date">Trade Date <p-sortIcon field="trade_date"></p-sortIcon></th>
      </tr>
    </ng-template>

    <!-- Body -->
    <ng-template pTemplate="body" let-entity>
      <tr>
        <td><p-tag [value]="entity.order_type" [severity]="getSeverity(entity.order_type)" /></td>
        <td>{{ entity.trade_price | number:'1.2-2' }}</td>
        <td>{{ entity.cheque | number:'1.2-2' }}</td>
        <td>{{ entity.net_amount | number:'1.2-2' }}</td>
        <td>{{ entity.trade_date | date:'dd-MM-yyyy' }}</td>
      </tr>
    </ng-template>

    <!-- Footer (Summary Row) -->
    <!-- <ng-template pTemplate="footer">
      <tr class="summary-row">
        <td colspan="3" class="summary green">
          Purchases → Units: {{ totalPurchaseUnits | number:'1.2-2' }} |
          Amount: {{ totalPurchaseAmount | currency:'INR' }}
        </td>
        <td colspan="3" class="summary blue">
          Available → Units: {{ availableUnits | number:'1.2-2' }} |
          Amount: {{ availableAmount | currency:'INR' }}
        </td>
        <td colspan="3" class="summary red text-right">
          Sales → Units: {{ totalSalesUnits | number:'1.2-2' }} |
          Amount: {{ totalSalesAmount | currency:'INR' }}
        </td>
      </tr>
    </ng-template> -->

  </p-table>
</div>

<div class="table-card">
   <h4>Summary Of AMC Action</h4>
  <div class="search-header p-d-flex p-ai-center p-jc-between">

  <div class="underlying-date">
      Last Updated At
      <span class="date-badge">
        {{ AMCActionTableList[0]?.created_at | date:'dd MMM yyyy' }}
      </span>
    </div> 

    <div class="search-container">
      <input
        pInputText
        type="text"
        (input)="onGlobalFilter($event, 'underlying')"
        placeholder="Search underlying..."
      />
    </div>
  </div>
  
  <p-table #underlyingTable [value]="AMCActionTableList" dataKey="id" [paginator]="true" [rows]="10"
    [rowsPerPageOptions]="[10,25,50]" [globalFilterFields]="['scripcode','weightage','isin_code','company_name']"
    scrollHeight="600px" responsiveLayout="scroll" [resizableColumns]="true" columnResizeMode="expand"
    class="custom-table">

    <!-- Header -->
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="security_description">Description <p-sortIcon field="security_description"></p-sortIcon></th>
        <th pSortableColumn="order_type">Order Type <p-sortIcon field="scripcode"></p-sortIcon></th>
        <th pSortableColumn="quantity">Quantity <p-sortIcon field="quantity"></p-sortIcon></th>
        <th pSortableColumn="trade_price">Trade Price <p-sortIcon field="trade_price"></p-sortIcon></th>
        <th pSortableColumn="net_amount">Net Amount <p-sortIcon field="net_amount"></p-sortIcon></th>
      </tr>
    </ng-template>

    <!-- Body -->
    <ng-template pTemplate="body" let-entity>
      <tr>
        <td>{{ entity.security_description }}</td>
        <td><p-tag [value]="entity.order_type" [severity]="getSeverity(entity.order_type)" /></td>
        <td>{{ entity.quantity }}</td>
        <td>{{ entity.trade_price }}</td>
        <td>{{ entity.net_amount }}</td>
      </tr>
    </ng-template>

  </p-table>
</div>

<!-- Pie Chart Card
<div class="counts-card" style="margin-bottom: 2rem;">
  <p-card styleClass="P-card">
    <h4>MCAP Tag Allocation</h4>
    <div class="card-content">
      <div class="counts-section">
        <div>
          <h4>Total Number of Underlying : {{AMCActionTableList.length}}</h4>
        </div>
        <div class="count-item">
          <span class="dot lcap"></span>
          <span class="label">Large Cap</span>
          <span class="percent">{{ actionCounts?.lcap_percent | number:'1.0-1' }}%</span>
        </div>
        <div class="count-item">
          <span class="dot mcap"></span>
          <span class="label">Mid Cap</span>
          <span class="percent">{{ actionCounts?.mcap_percent | number:'1.0-1' }}%</span>
        </div>
        <div class="count-item">
          <span class="dot scap"></span>
          <span class="label">Small Cap</span>
          <span class="percent">{{ actionCounts?.scap_percent | number:'1.0-1' }}%</span>
        </div>
      </div>

      <div class="chart-section">
        <p-chart type="pie" [data]="chartData" [options]="chartOptions"></p-chart>
      </div>
    </div>
  </p-card>
</div> -->